# 小怪图片生成说明

## 功能概述

使用豆包AI图片生成API，为游戏生成5个中国水墨风格的小怪图片，并在游戏中随机使用这些图片替代原来的简单图形。

## 生成的图片

已生成5张小怪图片，保存在 `public/images/monsters/` 目录：
- `monster1.png` - 可爱小妖怪
- `monster2.png` - 圆润小恶鬼
- `monster3.png` - Q版小魔物
- `monster4.png` - 萌系小妖精
- `monster5.png` - 卡通小怪兽

## 图片风格

- **风格**：中国水墨画风格
- **特点**：黑色墨迹、简���线条、透明背景
- **尺寸**：512x512像素
- **用途**：游戏角色设计

## 使用方式

### 1. 生成图片

运行脚本生成小怪图片：

```bash
cd scripts
bash generate-monsters.sh
```

### 2. 游戏集成

游戏会自动：
1. 在组件挂载时加载5张小怪图片
2. 生成敌人时随机选择一张图片（imageIndex: 0-4）
3. 绘制敌人时使用对应的图片
4. 如果图片未加载，使用后备方案（红色圆形）

## 技术实现

### 敌人类型定义（useLevel.ts）

```typescript
export type Enemy = {
  id: string
  type: 'monster' | 'target' | 'projectile'
  position: Vector2D
  size: number
  health: number
  maxHealth: number
  speed: number
  direction: Vector2D
  isAlive: boolean
  spawnTime: number
  imageIndex?: number  // 小怪图片索引（0-4）
}
```

### 图片加载（GameCanvas.vue）

```typescript
// 小怪图片缓存
const monsterImages = ref<HTMLImageElement[]>([])
const monsterImagesLoaded = ref(false)

// 加载小怪图片
const loadMonsterImages = () => {
  const imageCount = 5
  for (let i = 1; i <= imageCount; i++) {
    const img = new Image()
    img.src = `/images/monsters/monster${i}.png`
    img.onload = () => {
      // 加载完成处理
    }
    monsterImages.value.push(img)
  }
}
```

### 随机选择图片（useLevel.ts）

```typescript
const enemy: Enemy = {
  // ... 其他属性
  imageIndex: type === 'monster' ? Math.floor(Math.random() * 5) : undefined
}
```

### 绘制敌人（GameCanvas.vue）

```typescript
if (enemy.type === 'monster') {
  if (monsterImagesLoaded.value && enemy.imageIndex !== undefined) {
    const img = monsterImages.value[enemy.imageIndex]
    ctx.drawImage(img, x - size / 2, y - size / 2, size, size)
  } else {
    // 后备方案：绘制简单图形
  }
}
```

## API配置

- **API密钥**：0940f8e3-f5e4-4430-81ec-b48c6bbfda4c
- **模型**：doubao-seedream-3-0-t2i-250415
- **接口**：https://ark.cn-beijing.volces.com/api/v3/images/generations

## 注意事项

1. **图片有效期**：生成的图片URL有24小时有效期，已下载到本地
2. **后备方案**：如果图片加载失败，会使用原来的红色圆形图形
3. **随机性**：每次生成敌人时随机选择一张图片，增加游戏多样性
4. **性能**：图片在组件挂载时一次性加载，不影响游戏性能

## 效果

- ✅ 5张AI生成的水墨风格小怪图片
- ✅ 游戏中随机使用不同的小怪形象
- ✅ 保持水墨风格的统一视觉效果
- ✅ 提升游戏的视觉表现力

## 相关文件

- `scripts/generate-monsters.sh` - 图片生成脚本
- `public/images/monsters/` - 图片存储目录
- `composables/useLevel.ts` - 敌人类型定义和生成逻辑
- `components/game/GameCanvas.vue` - 图片加载和绘制逻辑
- `docs/豆包API图片生成使用指南.md` - API使用文档
